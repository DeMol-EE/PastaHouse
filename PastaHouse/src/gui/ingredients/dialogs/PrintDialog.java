/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package gui.ingredients.dialogs;

import gui.ingredients.controllers.PrintDialogDelegate;
import java.awt.Color;
import java.awt.event.KeyEvent;
import javax.swing.JOptionPane;

/**
 *
 * @author Warkst
 */
public class PrintDialog extends javax.swing.JDialog {

    private final PrintDialogDelegate delegate;
    
    /**
     * Creates new form PrintDialog
     */
    public PrintDialog(java.awt.Frame parent, boolean modal, PrintDialogDelegate delegate) {
	super(parent, modal);
	initComponents();
	
	setTitle("Hoeveelheid:");
	
	setLocationRelativeTo(null);
	
	setResizable(false);
	
	buttonGroup1.add(pieces);
	buttonGroup1.add(weight);
	weight.setSelected(true);
	
	this.delegate = delegate;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        quantityOutlet = new javax.swing.JTextField();
        jPanel2 = new javax.swing.JPanel();
        weight = new javax.swing.JRadioButton();
        pieces = new javax.swing.JRadioButton();
        jPanel3 = new javax.swing.JPanel();
        back = new javax.swing.JButton();
        print = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        quantityOutlet.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                quantityOutletKeyReleased(evt);
            }
        });
        getContentPane().add(quantityOutlet, java.awt.BorderLayout.NORTH);

        jPanel2.setFocusable(false);
        jPanel2.setLayout(new java.awt.GridLayout(2, 1));

        weight.setText("Kg");
        weight.setFocusable(false);
        jPanel2.add(weight);

        pieces.setText("Stuks");
        pieces.setFocusable(false);
        jPanel2.add(pieces);

        getContentPane().add(jPanel2, java.awt.BorderLayout.CENTER);

        jPanel3.setFocusable(false);
        jPanel3.setLayout(new java.awt.BorderLayout());

        back.setText("Terug");
        back.setFocusable(false);
        back.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                backActionPerformed(evt);
            }
        });
        jPanel3.add(back, java.awt.BorderLayout.WEST);

        print.setText("Printen");
        print.setFocusable(false);
        print.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                printActionPerformed(evt);
            }
        });
        jPanel3.add(print, java.awt.BorderLayout.EAST);

        getContentPane().add(jPanel3, java.awt.BorderLayout.SOUTH);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void printActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_printActionPerformed
        try{
	    final double q = Double.parseDouble(quantityOutlet.getText());
	    
	    if (pieces.isSelected()){
		new Thread(new Runnable() {

		    @Override
		    public void run() {
			delegate.printAmount(q);
		    }
		}).start();
	    } else {
		new Thread(new Runnable() {

		    @Override
		    public void run() {
			delegate.printQuantity(q);
		    }
		}).start();
	    }

	    this.dispose();
	} catch (Exception e){
	    JOptionPane.showMessageDialog(null, "Geef een geldige waarde in!", "Error", JOptionPane.ERROR_MESSAGE);
	    quantityOutlet.setSelectionStart(0);
	    quantityOutlet.setSelectionEnd(quantityOutlet.getText().length());
	    quantityOutlet.requestFocus();
	}
	
	
    }//GEN-LAST:event_printActionPerformed

    private void backActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_backActionPerformed
        this.dispose();
    }//GEN-LAST:event_backActionPerformed

    private void quantityOutletKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_quantityOutletKeyReleased
        try{
	    Double.parseDouble(quantityOutlet.getText());
	    quantityOutlet.setForeground(Color.black);
	} catch (Exception e){
	    quantityOutlet.setForeground(Color.red);
	}
	if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
	    printActionPerformed(null);
	} else if (evt.getKeyCode() == KeyEvent.VK_ESCAPE){
	    backActionPerformed(null);
	}
    }//GEN-LAST:event_quantityOutletKeyReleased

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton back;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JRadioButton pieces;
    private javax.swing.JButton print;
    private javax.swing.JTextField quantityOutlet;
    private javax.swing.JRadioButton weight;
    // End of variables declaration//GEN-END:variables
}
